<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Suppression of a summarised_result obejct • omopgenerics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Suppression of a summarised_result obejct">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">omopgenerics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Classes</h6></li>
    <li><a class="dropdown-item" href="../articles/cdm_reference.html">The cdm reference</a></li>
    <li><a class="dropdown-item" href="../articles/codelists.html">Concept sets</a></li>
    <li><a class="dropdown-item" href="../articles/cohorts.html">Cohort tables</a></li>
    <li><a class="dropdown-item" href="../articles/summarised_result.html">A summarised result</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>OMOP Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/suppression.html">Suppression of a summarised_result obejct</a></li>
    <li><a class="dropdown-item" href="../articles/logging.html">Logging with omopgenerics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Principles</h6></li>
    <li><a class="dropdown-item" href="../articles/reexport.html">Re-exporting functions from omopgnerics</a></li>
    <li><a class="dropdown-item" href="../articles/expanding_omopgenerics.html">Expanding omopgenerics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/darwin-eu/omopgenerics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Suppression of a summarised_result obejct</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/omopgenerics/blob/main/vignettes/suppression.Rmd" class="external-link"><code>vignettes/suppression.Rmd</code></a></small>
      <div class="d-none name"><code>suppression.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="minimum-cell-count-suppression">Minimum cell count suppression<a class="anchor" aria-label="anchor" href="#minimum-cell-count-suppression"></a>
</h2>
<p>Minimum cell count suppression is very important in studies as it is
essential step to ensure no reidentification. The min cell count
suppression can vary source to source, but in general a minimum cell
count of 5 is fixed. In this vignette we explain how the suppression
process works for <code>summarised_result</code> objects.</p>
<div class="section level3">
<h3 id="how-suppression-works">How suppression works<a class="anchor" aria-label="anchor" href="#how-suppression-works"></a>
</h3>
<p>In general a record is suppressed if 3 conditions are met:</p>
<ol style="list-style-type: decimal">
<li>The <code>estimate_name</code> field contains the word ‘count’ (e.g
‘count’, ‘outcome_count’, ‘count_of_individuals’, …).</li>
<li>The <code>estimate_type</code> field is either <em>numeric</em> or
<em>integer</em>.</li>
<li>The <code>estimate_value</code> numeric value is smaller than
<em>minCellCount</em> and bigger than 0.</li>
</ol>
<p>This simple rule determines the suppression at record level. The
suppressed record is not removed from the results, instead the
<code>estimate_value</code> field is populated as
‘&lt;{minCellCount}’.</p>
<p>Once one record is suppressed this can trigger suppression of other
<em>linked</em> estimates. This suppression is done at different level
and affects different rows of the result object:</p>
<ul>
<li><p><strong>Suppression at group level</strong>: if in the suppressed
estimate the field <code>variable_name</code> is populated with the word
“number records” or “number subjects” (it is not case sensitive) then
the whole group of records will be suppressed. Note a group of records
is a set of rows with the same: <code>result_id</code>,
<code>cdm_name</code>, <code>group_name</code>,
<code>group_level</code>, <code>strata_name</code>,
<code>strata_level</code>, <code>additional_name</code>,
<code>additional_level</code>. This level of suppression is for example
to suppress all the demographics of a cohort of individuals that has
less than the minimum amount of records required. For developers note
that creating a row with <code>variable_name</code> = “number
records/subjects” can have a big impact on the suppression, but at the
same point it gives you the ability to link a group of estimates and
suppress all of them at the same point.</p></li>
<li><p><strong>Suppression at variable_name level</strong>: if in the
suppressed estimate the field <code>estimate_name</code> is populated
with either “count”, “denominator_count”, “outcome_count”,
“record_count” or “subject_count” then the suppression is done at the
variable level, meaning that all the estimates with the same:
<code>result_id</code>, <code>cdm_name</code>, <code>group_name</code>,
<code>group_level</code>, <code>strata_name</code>,
<code>strata_level</code>, <code>additional_name</code>,
<code>additional_level</code> and <code>variable_name</code> will be
suppressed. This level of suppression is for example to suppress the
statistics associated with an outcome count for example, but not do not
affect the different outcomes for example. For developers use one of
this key words to link the estimates at the variable level.</p></li>
<li><p><strong>Suppression of percentages</strong>: if an estimate is
suppressed any estimate in the same level (same <code>result_id</code>,
<code>cdm_name</code>, <code>group_name</code>,
<code>group_level</code>, <code>strata_name</code>,
<code>strata_level</code>, <code>additional_name</code>,
<code>additional_level</code>, <code>variable_name</code> and
<code>variable_level</code>) with the same estimate name but changing
‘count’ for ‘percentage’ (e.g. ‘event_count’ -&gt; ‘event_percentage’)
will be suppressed.</p></li>
</ul>
<p>Note that linked estimate records will be suppressed as ‘-’.</p>
<p>You can view the source code for minimum cell suppression <a href="https://github.com/darwin-eu/omopgenerics/blob/main/R/methodSuppress.R" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="suppressing-a-summarised_result-object">Suppressing a summarised_result object<a class="anchor" aria-label="anchor" href="#suppressing-a-summarised_result-object"></a>
</h3>
<p>Once we have a summarised result, we can suppress the object based on
a desired minimum cell count value using the <a href="https://darwin-eu.github.io/omopgenerics/reference/suppress.html"><code>suppress()</code></a>
function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/omopgenerics/">omopgenerics</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newSummarisedResult.html">newSummarisedResult</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    result_id <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    cdm_name <span class="op">=</span> <span class="st">"my_cdm"</span>,</span>
<span>    group_name <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span>    group_level <span class="op">=</span> <span class="st">"cohort1"</span>,</span>
<span>    strata_name <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>    strata_level <span class="op">=</span> <span class="st">"male"</span>,</span>
<span>    variable_name <span class="op">=</span> <span class="st">"Age group"</span>,</span>
<span>    variable_level <span class="op">=</span> <span class="st">"10 to 50"</span>,</span>
<span>    estimate_name <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>    estimate_type <span class="op">=</span> <span class="st">"numeric"</span>,</span>
<span>    estimate_value <span class="op">=</span> <span class="st">"5"</span>,</span>
<span>    additional_name <span class="op">=</span> <span class="st">"overall"</span>,</span>
<span>    additional_level <span class="op">=</span> <span class="st">"overall"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  settings <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    result_id <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    package_name <span class="op">=</span> <span class="st">"PatientProfiles"</span>,</span>
<span>    package_version <span class="op">=</span> <span class="st">"1.0.0"</span>,</span>
<span>    study <span class="op">=</span> <span class="st">"my_characterisation_study"</span>,</span>
<span>    result_type <span class="op">=</span> <span class="st">"stratified_by_age_group"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">suppressedResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/suppress.html">suppress</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">result</span>, minCellCount <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="is-a-summarised_result-object-suppressed">Is a summarised_result object suppressed?<a class="anchor" aria-label="anchor" href="#is-a-summarised_result-object-suppressed"></a>
</h3>
<p>The minCellCount suppression is recorded in the settings of the
object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="fu"><a href="../reference/settings.html">settings</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; $ result_id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ result_type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "stratified_by_age_group"</span></span>
<span><span class="co">#&gt; $ package_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PatientProfiles"</span></span>
<span><span class="co">#&gt; $ package_version <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1.0.0"</span></span>
<span><span class="co">#&gt; $ group           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_name"</span></span>
<span><span class="co">#&gt; $ strata          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "sex"</span></span>
<span><span class="co">#&gt; $ additional      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> ""</span></span>
<span><span class="co">#&gt; $ min_cell_count  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0"</span></span>
<span><span class="co">#&gt; $ study           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "my_characterisation_study"</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="fu"><a href="../reference/settings.html">settings</a></span><span class="op">(</span><span class="va">suppressedResult</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; $ result_id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ result_type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "stratified_by_age_group"</span></span>
<span><span class="co">#&gt; $ package_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PatientProfiles"</span></span>
<span><span class="co">#&gt; $ package_version <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1.0.0"</span></span>
<span><span class="co">#&gt; $ group           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_name"</span></span>
<span><span class="co">#&gt; $ strata          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "sex"</span></span>
<span><span class="co">#&gt; $ additional      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> ""</span></span>
<span><span class="co">#&gt; $ min_cell_count  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "7"</span></span>
<span><span class="co">#&gt; $ study           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "my_characterisation_study"</span></span></code></pre></div>
<p>As a result object can be partially suppressed (e.g. binding an
object that has already been suppressed with another one that is not
suppressed) and settings of results objects can be long we also have a
utility function to check if an object has been suppressed or not, <a href="https://darwin-eu.github.io/omopgenerics/reference/isResultSuppressed.html"><code>isResultSuppressed()</code></a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/isResultSuppressed.html">isResultSuppressed</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">result</span>, minCellCount <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BB0000;">✖</span> 1 set (1 row) not suppressed.</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/isResultSuppressed.html">isResultSuppressed</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">suppressedResult</span>, minCellCount <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BBBB00;">!</span> 1 set (1 row) suppressed with minCellCount &gt; 5.</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/isResultSuppressed.html">isResultSuppressed</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">suppressedResult</span>, minCellCount <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> The <span style="color: #0000BB;">&lt;summarised_result&gt;</span> is suppressed with</span></span>
<span><span class="co">#&gt; minCellCount = 7.</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/isResultSuppressed.html">isResultSuppressed</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">suppressedResult</span>, minCellCount <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BB0000;">✖</span> 1 set (1 row) suppressed with minCellCount &lt; 10.</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martí Català, Edward Burn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
